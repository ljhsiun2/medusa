.global s_prepare_buffers
s_prepare_buffers:
push %r10
push %r12
push %r13
push %rcx
push %rdi
push %rsi
lea addresses_normal_ht+0x2ef3, %rsi
clflush (%rsi)
nop
sub %r12, %r12
mov (%rsi), %r10d
nop
add %rdi, %rdi
lea addresses_WT_ht+0x14c6b, %rsi
lea addresses_WT_ht+0x312b, %rdi
nop
dec %r10
mov $72, %rcx
rep movsq
add $35252, %r10
lea addresses_WT_ht+0xc92b, %rsi
lea addresses_A_ht+0x625b, %rdi
nop
and %r13, %r13
mov $94, %rcx
rep movsb
nop
nop
nop
xor %r12, %r12
pop %rsi
pop %rdi
pop %rcx
pop %r13
pop %r12
pop %r10
ret

    .global s_faulty_load
s_faulty_load:
push %r10
push %r11
push %r12
push %r14
push %r9
push %rcx
push %rdx

// Store
mov $0x12b, %r9
nop
nop
nop
nop
dec %r12
movw $0x5152, (%r9)
nop
nop
nop
nop
xor $13294, %rdx

// Faulty Load
mov $0x12b, %rcx
nop
nop
sub %r14, %r14
movntdqa (%rcx), %xmm7
vpextrq $0, %xmm7, %r11
lea oracles, %r9
and $0xff, %r11
shlq $12, %r11
mov (%r9,%r11,1), %r11
pop %rdx
pop %rcx
pop %r9
pop %r14
pop %r12
pop %r11
pop %r10
ret

/*
<gen_faulty_load>
[REF]
{'src': {'same': False, 'congruent': 0, 'NT': False, 'type': 'addresses_P', 'size': 8, 'AVXalign': False}, 'OP': 'LOAD'}
{'OP': 'STOR', 'dst': {'same': True, 'congruent': 0, 'NT': False, 'type': 'addresses_P', 'size': 2, 'AVXalign': False}}
[Faulty Load]
{'src': {'same': True, 'congruent': 0, 'NT': True, 'type': 'addresses_P', 'size': 16, 'AVXalign': False}, 'OP': 'LOAD'}
<gen_prepare_buffer>
{'src': {'same': False, 'congruent': 2, 'NT': False, 'type': 'addresses_normal_ht', 'size': 4, 'AVXalign': False}, 'OP': 'LOAD'}
{'src': {'type': 'addresses_WT_ht', 'congruent': 6, 'same': False}, 'OP': 'REPM', 'dst': {'type': 'addresses_WT_ht', 'congruent': 8, 'same': False}}
{'src': {'type': 'addresses_WT_ht', 'congruent': 1, 'same': False}, 'OP': 'REPM', 'dst': {'type': 'addresses_A_ht', 'congruent': 3, 'same': False}}
{'9a': 3, 'ec': 4, '66': 2, 'a2': 2, '4e': 1, '2e': 4, 'fc': 3, 'd0': 5, '30': 2, '7c': 5, '3a': 2, '6e': 6, '54': 1, '24': 4, 'be': 1, '72': 1, 'b8': 2, '82': 5, '3e': 2, 'c6': 2, '0a': 1, '62': 3, '38': 3, 'de': 3, 'ae': 2, '7a': 2, '42': 2, '34': 1, 'b6': 4, '40': 1, '20': 1, '3c': 1, 'ba': 2, 'fe': 2, 'f0': 3, '1a': 1, 'e0': 2, 'aa': 3, 'c8': 1, '8a': 1, '5e': 3, '7e': 1, 'd4': 4, '60': 3, '28': 8, '1c': 1, '76': 3, '18': 1, '70': 4, '5a': 3, '08': 2, 'd2': 1, '46': 1, 'b0': 3, 'b2': 1, '32': 4, '68': 6, 'f4': 1, 'c2': 3, 'f6': 2, '90': 3, '04': 2, '96': 1, '92': 2, 'e4': 2, '4c': 1, '10': 3, '5c': 4, 'ce': 3, '0c': 3, '26': 3, '44': 3, 'f2': 3, 'e2': 1, '00': 408, '22': 3, '8e': 3, 'd6': 3, '48': 1, '52': 21123, 'ea': 1, '06': 2, 'fa': 2, '94': 2, '2a': 2, 'e8': 4, '80': 4, '9c': 6, '84': 2, '1e': 4, 'c0': 1, '4a': 1, '74': 1, 'da': 2, 'bc': 6, 'b4': 4, 'd8': 4, '64': 2, '78': 3, '8c': 2, '50': 1, 'ac': 5, 'a8': 3, 'a6': 3, '9e': 2, '0e': 3, 'a0': 3, '86': 4, '02': 3, '98': 1, '16': 5, 'cc': 3, 'f8': 2, 'c4': 1, '36': 2, 'ee': 4, 'dc': 3}
52 52 52 0c 52 52 52 52 52 52 52 0a 52 52 a0 52 52 52 76 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 aa 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 1e 52 52 00 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 22 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 0c 52 52 52 52 52 52 52 52 52 52 52 52 52 00 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 cc 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 00 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 52 52 36 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 52 00 52 52 52 52 52 52 52 52
*/
